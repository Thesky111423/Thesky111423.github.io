<body>

    <div class="theme-switcher" id="theme-switcher">ğŸŒ™</div>

    <div class="page-wrapper">
        <aside class="time-panel">
            <div id="clock"></div>
            <p id="suggestion"></p>
            <!-- ã€é‡å¤§æ›´æ–°ã€‘HTMLç»“æ„å·²æ”¹ä¸ºä¸è’œå­è¦æ±‚çš„æ ¼å¼ -->
            <p id="visitor-counter">
                æ‚¨æ˜¯ç¬¬ <strong id="busuanzi_value_site_uv"></strong> ä½è®¿å®¢
            </p>
            <p id="thank-you-note">è°¢è°¢ä½ çš„è®¿é—®!!</p>
        </aside>
        <main class="main-content">
            <h1>æ¯æ—¥ä¸€å¥è¯</h1>
            <div id="quote-container" class="card">
                <h2>ä»¥ä¸‹ä¾¿æ˜¯</h2>
                <p id="quote-text">æ­£åœ¨å¯»æ‰¾ä¹¦ä¸­çš„æ™ºæ…§...</p>
                <p id="quote-author"></p>
            </div>
            <div id="notes-container" class="card">
                <h2>æˆ‘çš„ä¾¿ç­¾</h2>
                <input type="text" id="user-note" placeholder="å†™ä¸‹ä»»ä½•ä½ æƒ³å¯¹è‡ªå·±è¯´çš„è¯...">
                <div class="save-status" id="save-status">å·²è‡ªåŠ¨ä¿å­˜</div>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            const themeSwitcher = document.getElementById('theme-switcher');
            const body = document.body;
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') { body.classList.add('dark-mode'); themeSwitcher.textContent = 'â˜€ï¸'; }
            themeSwitcher.addEventListener('click', function() {
                body.classList.toggle('dark-mode');
                if (body.classList.contains('dark-mode')) {
                    themeSwitcher.textContent = 'â˜€ï¸'; localStorage.setItem('theme', 'dark');
                } else {
                    themeSwitcher.textContent = 'ğŸŒ™'; localStorage.setItem('theme', 'light');
                }
            });

            const clockElem = document.getElementById('clock');
            const suggestionElem = document.getElementById('suggestion');
            function padZero(num) { return num < 10 ? '0' + num : num; }
            function updateTimeAndSuggestion() {
                const now = new Date(); const hours = now.getHours();
                clockElem.textContent = `${padZero(hours)}:${padZero(now.getMinutes())}:${padZero(now.getSeconds())}`;
                let suggestionText = '';
                if (hours >= 5 && hours < 8) { suggestionText = "æ¸…æ™¨å¥½ã€‚æ–°çš„ä¸€å¤©å¼€å§‹äº†ï¼Œè®°å¾—ç»™è‡ªå·±ä¸€ä¸ªå¾®ç¬‘ã€‚"; } 
                else if (hours >= 8 && hours < 12) { suggestionText = "ä¸Šåˆå¥½ã€‚ä¸“æ³¨çš„æ—¶å…‰æ€»æ˜¯è¿‡å¾—å¾ˆå¿«ï¼Œå–æ¯æ°´ä¼‘æ¯ä¸€ä¸‹å§ã€‚"; } 
                else if (hours >= 12 && hours < 14) { suggestionText = "åˆåæ—¶å…‰ã€‚å¥½å¥½åƒé¥­ï¼Œå°æ†©ç‰‡åˆ»ï¼Œä¸ºä¸‹åˆå‚¨å¤‡èƒ½é‡ã€‚"; } 
                else if (hours >= 14 && hours < 18) { suggestionText = "ä¸‹åˆå¥½ã€‚å¦‚æœæœ‰äº›ç–²æƒ«ï¼Œä¸å¦¨ç«™èµ·æ¥çœ‹çœ‹çª—å¤–ã€‚"; } 
                else if (hours >= 18 && hours < 22) { suggestionText = "å¤œå¹•é™ä¸´ã€‚æ”¾ä¸‹å¿™ç¢Œï¼Œäº«å—å±äºè‡ªå·±çš„å®é™æ—¶åˆ»å§ã€‚"; } 
                else { suggestionText = "å¤œæ·±äº†ã€‚ä¸–ç•Œç¡äº†ï¼Œè¯·ä½ ä¹Ÿæ—©ç‚¹ä¼‘æ¯ï¼Œæ™šå®‰ã€‚"; }
                suggestionElem.textContent = suggestionText;
            }

            const quoteTextElem = document.getElementById('quote-text');
            const quoteAuthorElem = document.getElementById('quote-author');
            function getDailyQuote() {
                fetch('https://v1.hitokoto.cn/?c=d&c=k&encode=json')
                    .then(response => response.json())
                    .then(data => {
                        const authorText = data.from_who ? `${data.from_who} ` : '';
                        quoteTextElem.textContent = `â€œ${data.hitokoto}â€`;
                        quoteAuthorElem.textContent = `â€” ${authorText}ã€Š${data.from}ã€‹`;
                    })
                    .catch(error => {
                        console.error('è·å–åè¨€å¤±è´¥:', error);
                        quoteTextElem.textContent = "â€œä¸€ä¸ªäººå¯ä»¥è¢«æ¯ç­ï¼Œä½†ä¸èƒ½è¢«æ‰“è´¥ã€‚â€";
                        quoteAuthorElem.textContent = "â€” æµ·æ˜å¨ã€Šè€äººä¸æµ·ã€‹";
                    });
            }

            const userNoteInput = document.getElementById('user-note');
            const saveStatusElem = document.getElementById('save-status');
            function loadNote() { const savedNote = localStorage.getItem('userPersonalNote'); if (savedNote) { userNoteInput.value = savedNote; } }
            let saveTimeout;
            userNoteInput.addEventListener('input', function() { clearTimeout(saveTimeout); localStorage.setItem('userPersonalNote', userNoteInput.value); saveStatusElem.style.opacity = 1; saveTimeout = setTimeout(() => { saveStatusElem.style.opacity = 0; }, 2000); });
            
            // ã€é‡å¤§æ›´æ–°ã€‘JavaScriptä¸­çš„è®¡æ•°å‡½æ•°å·²å®Œå…¨ç§»é™¤

            updateTimeAndSuggestion();
            setInterval(updateTimeAndSuggestion, 1000);
            getDailyQuote();
            loadNote();
        });
    </script>
</body>
