<body>

    <div class="theme-switcher" id="theme-switcher">🌙</div>

    <div class="page-wrapper">
        <aside class="time-panel">
            <div id="clock"></div>
            <p id="suggestion"></p>
            <!-- 【重大更新】HTML结构已改为不蒜子要求的格式 -->
            <p id="visitor-counter">
                您是第 <strong id="busuanzi_value_site_uv"></strong> 位访客
            </p>
            <p id="thank-you-note">谢谢你的访问!!</p>
        </aside>
        <main class="main-content">
            <h1>每日一句话</h1>
            <div id="quote-container" class="card">
                <h2>以下便是</h2>
                <p id="quote-text">正在寻找书中的智慧...</p>
                <p id="quote-author"></p>
            </div>
            <div id="notes-container" class="card">
                <h2>我的便签</h2>
                <input type="text" id="user-note" placeholder="写下任何你想对自己说的话...">
                <div class="save-status" id="save-status">已自动保存</div>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            const themeSwitcher = document.getElementById('theme-switcher');
            const body = document.body;
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') { body.classList.add('dark-mode'); themeSwitcher.textContent = '☀️'; }
            themeSwitcher.addEventListener('click', function() {
                body.classList.toggle('dark-mode');
                if (body.classList.contains('dark-mode')) {
                    themeSwitcher.textContent = '☀️'; localStorage.setItem('theme', 'dark');
                } else {
                    themeSwitcher.textContent = '🌙'; localStorage.setItem('theme', 'light');
                }
            });

            const clockElem = document.getElementById('clock');
            const suggestionElem = document.getElementById('suggestion');
            function padZero(num) { return num < 10 ? '0' + num : num; }
            function updateTimeAndSuggestion() {
                const now = new Date(); const hours = now.getHours();
                clockElem.textContent = `${padZero(hours)}:${padZero(now.getMinutes())}:${padZero(now.getSeconds())}`;
                let suggestionText = '';
                if (hours >= 5 && hours < 8) { suggestionText = "清晨好。新的一天开始了，记得给自己一个微笑。"; } 
                else if (hours >= 8 && hours < 12) { suggestionText = "上午好。专注的时光总是过得很快，喝杯水休息一下吧。"; } 
                else if (hours >= 12 && hours < 14) { suggestionText = "午后时光。好好吃饭，小憩片刻，为下午储备能量。"; } 
                else if (hours >= 14 && hours < 18) { suggestionText = "下午好。如果有些疲惫，不妨站起来看看窗外。"; } 
                else if (hours >= 18 && hours < 22) { suggestionText = "夜幕降临。放下忙碌，享受属于自己的宁静时刻吧。"; } 
                else { suggestionText = "夜深了。世界睡了，请你也早点休息，晚安。"; }
                suggestionElem.textContent = suggestionText;
            }

            const quoteTextElem = document.getElementById('quote-text');
            const quoteAuthorElem = document.getElementById('quote-author');
            function getDailyQuote() {
                fetch('https://v1.hitokoto.cn/?c=d&c=k&encode=json')
                    .then(response => response.json())
                    .then(data => {
                        const authorText = data.from_who ? `${data.from_who} ` : '';
                        quoteTextElem.textContent = `“${data.hitokoto}”`;
                        quoteAuthorElem.textContent = `— ${authorText}《${data.from}》`;
                    })
                    .catch(error => {
                        console.error('获取名言失败:', error);
                        quoteTextElem.textContent = "“一个人可以被毁灭，但不能被打败。”";
                        quoteAuthorElem.textContent = "— 海明威《老人与海》";
                    });
            }

            const userNoteInput = document.getElementById('user-note');
            const saveStatusElem = document.getElementById('save-status');
            function loadNote() { const savedNote = localStorage.getItem('userPersonalNote'); if (savedNote) { userNoteInput.value = savedNote; } }
            let saveTimeout;
            userNoteInput.addEventListener('input', function() { clearTimeout(saveTimeout); localStorage.setItem('userPersonalNote', userNoteInput.value); saveStatusElem.style.opacity = 1; saveTimeout = setTimeout(() => { saveStatusElem.style.opacity = 0; }, 2000); });
            
            // 【重大更新】JavaScript中的计数函数已完全移除

            updateTimeAndSuggestion();
            setInterval(updateTimeAndSuggestion, 1000);
            getDailyQuote();
            loadNote();
        });
    </script>
</body>
